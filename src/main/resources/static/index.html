<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>极客星辰个人博客</title>
	</head>

	<link href="/plugin/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="/css/common.css" />
	<link href="/logo.ico" rel="shortcut icon" />
	<script src="/plugin/jquery.min.js"></script>
	<script src="/plugin/bootstrap/js/bootstrap.min.js"></script>
	<script src="/layui/layui.all.js"></script>
	<!--<script type="text/javascript" src="plugin/jquery.page.js"></script>-->
	<!--<script src="js/common.js"></script>-->
	<!--<script src="js/snowy.js"></script>-->

	<body>
		<div class="w_header">
			<div class="container">
				<div class="w_header_top">
					<a href="#" class="w_logo"></a>
					<span class="w_header_nav">
					<ul>
						<li><a href="/index.html" class="active">首页</a></li>
						<li><a href="/about.html">关于</a></li>
						<li><a href="/article.html">成长</a></li>
						<li><a href="/editor.html">写博客</a></li>
						<li><a href="">娱乐</a></li>
						<li><a href="/moodList.html">说说</a></li>
						<li><a href="/comment.html">留言</a></li>
					</ul>
				</span>
					<div class="w_search">
						<div class="w_searchbox">
							<input type="text" placeholder="百度一下" />
							<button class="btn-baidusearch">搜索</button>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="w_container">
			<div class="container">
				<div class="row w_main_row">
					<div class="col-lg-9 col-md-9 w_main_left">
						<!--滚动图开始-->
						<div class="panel panel-default">

							<div id="w_carousel" class="carousel slide w_carousel" data-ride="carousel">
								<!-- Indicators -->
								<ol class="carousel-indicators">
									<li data-target="#w_carousel" data-slide-to="0" class="active"></li>
									<li data-target="#w_carousel" data-slide-to="1"></li>
									<li data-target="#w_carousel" data-slide-to="2"></li>
									<li data-target="#w_carousel" data-slide-to="3"></li>
								</ol>

								<!-- Wrapper for slides -->
								<div class="carousel-inner" role="listbox">
									<div class="item active">
										<img src="/img/slider/slide1.jpg" alt="...">
										<div class="carousel-caption">
											<h3>First slide label</h3>
											<p>Nulla vitae elit libero, a pharetra augue mollis interdum.</p>
										</div>
									</div>
									<div class="item">
										<img src="/img/slider/slide2.jpg" alt="...">
										<div class="carousel-caption">...</div>
									</div>
									<div class="item">
										<img src="/img/slider/slide3.jpg" alt="...">
										<div class="carousel-caption">...</div>
									</div>
									<div class="item">
										<img src="/img/slider/slide4.jpg" alt="...">
										<div class="carousel-caption">...</div>
									</div>
								</div>

								<!-- Controls -->
								<a class="left carousel-control" href="#w_carousel" role="button" data-slide="prev">
									<span class="glyphicon glyphicon-chevron-left"></span>
									<span class="sr-only">Previous</span>
								</a>
								<a class="right carousel-control" href="#w_carousel" role="button" data-slide="next">
									<span class="glyphicon glyphicon-chevron-right"></span>
									<span class="sr-only">Next</span>
								</a>
							</div>

						</div>

						<div class="panel panel-default contenttop">
							<a href="#" class="bozhuzhiding-a">
								<strong>博主置顶</strong>
								<h3 class="title">嫁人就嫁程序员</h3>
								<p class="overView">
								博主 ：CG(CGgeeker)
								<br>
								Q Q : 2574691263
								<br>
								<span style="color: #e74c3c">自我描述 ：一个正二八百的健身爱好者 + 爱开发的IT人才！</span>
								</p>
							</a>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">
								<h3 class="panel-title">最新发布</h3>
							</div>

							<div class="panel-body">

								<!--文章列表开始-->
								<div class="contentList">

									<!--<div class="panel panel-default">
										<div class="panel-body">
											<div class="contentleft article-firstdiv">
												<h4><a class="title" href="/post/41501569">使用 Nginx 实现 tomcat、glassfish 等 web 服务器负载均衡</a></h4>
												<p>
													<a class="label label-default">Nginx</a>
													<a class="label label-default">tomcat负载均衡</a>
												</p>
												<p class="overView">1.web服务器负载均衡简介web服务器负载均衡是指将多台可用单节点服务器组合成web服务器集群，然后通过负载均衡器将客户端请求均匀的转发到不同的单节点web服务器上，从而增加整个web服务器集群的吞吐量。</p>
												<p><span class="count"><i class="glyphicon glyphicon-user"></i><a href="#">admin</a></span> <span class="count"><i class="glyphicon glyphicon-eye-open"></i>阅读:852</span><span class="count"><i class="glyphicon glyphicon-comment"></i>评论:99</span><span class="count"><i class="glyphicon glyphicon-time"></i>2016-08-25</span></p>
											</div>
											<div class="contentImage article-seconddiv">
												&lt;!&ndash;<img src="img/slider/67zmaej.png"/>&ndash;&gt;
												<div class="row">
													<a href="#" class="thumbnail w_thumbnail">
														<img src="/img/slider/67zmaej.png" alt="...">
													</a>
												</div>
											</div>
										</div>
									</div>-->

								</div>
								<!--文章列表结束-->

							</div>
						</div>
					</div>

					<!--左侧开始-->
					<div class="col-lg-3 col-md-3 w_main_right">

						<div class="panel panel-default sitetip">
							<a href="#" class="sitetip-a">
								<strong class="sitetip-sitetip">站点公告</strong>
								<h3 class="title sitetip-name"></h3>
								<p class="overView sitetip-content"></p>
							</a>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">
								<h3 class="panel-title">热门标签</h3>
							</div>
							<div class="panel-body">
								<div class="labelList">
									<!--<a class="label label-default">tomcat负载均衡</a>
									<a class="label label-default" href="/tag/Redis">Redis</a>-->
								</div>
							</div>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">
								<h3 class="panel-title">最新发布</h3>
							</div>
							<div class="panel-body">
								<ul class="list-unstyled sidebar newpublish-ul">
									<!--<li>
										<a href="/post/04928311">排序算法之冒泡排序 － java实现</a>
									</li>-->
								</ul>
							</div>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">
								<h3 class="panel-title">友情链接</h3>
							</div>
							<div class="panel-body">
								<div class="newContent">
									<ul class="list-unstyled sidebar shiplink">
										<li>
											<a href="https://www.baidu.com/" target="_blank">百度</a>
										</li>
										<li>
											<a href="https://www.oschina.net/" target="_blank">开源中国</a>
										</li>
										<li>
											<a href="http://www.ulewo.com/" target="_blank">有乐网</a>
										</li>
										<li>
											<a href="http://www.sina.com.cn/" target="_blank">新浪网</a>
										</li>
										<li>
											<a href="http://www.qq.com/" target="_blank">腾讯网</a>
										</li>
									</ul>
								</div>
							</div>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">
								<h3 class="panel-title">关注微信公众号</h3>
							</div>
							<div class="panel-body">
								<img src="/img/wechat.jpg" style="height: 230.5px;width: 230.5px;" />
							</div>
						</div>

					</div>
				</div>
			</div>
		</div>
		<div class="w_foot">
			<div class="w_foot_copyright">Copyright &copy; 2017-2020, www.cggeeker.cn. All Rights Reserved. <span>|</span>
				<a target="_blank" href="http://icp.chinaz.com/" rel="nofollow">蜀ICP备19013707号</a>
			</div>
		</div>
	</body>
	<script type="text/javascript">
		var $backToTopEle = $('<a href="javascript:void(0)" class="Hui-iconfont toTop" title="返回顶部" alt="返回顶部" style="display:none">^</a>').appendTo($("body")).click(function() {
			$("html, body").animate({ scrollTop: 0 }, 120);
		});
		var backToTopFun = function() {
			var st = $(document).scrollTop(),
				winh = $(window).height();
			(st > 0) ? $backToTopEle.show(): $backToTopEle.hide();
			/*IE6下的定位*/
			if(!window.XMLHttpRequest) {
				$backToTopEle.css("top", st + winh - 166);
			}
		};

		$(function() {
			$(window).on("scroll", backToTopFun);
			backToTopFun();
		});


		$(function () {

			<!--处理测试没有session情况下访问没有权限的模块的强制转跳验证-->
			$('.btn-baidusearch').click(function () {

				window.open("http://www.baidu.com","_blank");

				/*	$.ajax({
						type : "GET",
						url : "/user/getLoginUserSession",
						data :{},
						dataType : "json",
						success : function (result) {
							console.log(result);
							/!*alert("session数据："+result.data)*!/
							if(result.status==500){
								window.location.href = '/login.html';  // ajax控制跳转页面
							}
						},
						fail : function () {
							console.log("失败");
						},
						error : function () {
							console.log("错误");
						}

				});*/

			});


				<!--获取标签信息的ajax-->
				$.ajax({
					type : "GET",
					url : "/label/findAllLabel",
					data : {},
					dataType : "json",
					success : function (result) {
							if(result.status == 200){
								/*var listlength = result.data.length;*/
								var labelarr = result.data;
								//jquery动态拼接li标签
								for(let i in labelarr){
									$('.labelList').append('<a class="label label-default" href="https://blog.csdn.net/qq_40436854">'+labelarr[i].labelName+'</a>');
								}
							}else{}
					},
					fail : function () {
						console.log("获取标签失败！");
					},
					error : function () {
						console.log("获取标签错误！");
					}

				});

			<!--获取站点公告信息的ajax-->
			$.ajax({
				type : "GET",
				url : "/sitetip/findAllSiteTip",
				data : {},
				dataType : "json",
				success : function (result) {
					if(result.status == 200){

						var sitetiparr = result.data;

						//初始化站点公告样式
						$('.sitetip-a').css({"text-decoration":"none"}); //去掉站点公告a标签的下划线
						$('.bozhuzhiding-a').css({"text-decoration":"none"}); //去掉博主置顶a标签的下划线

						var t0 = window.setTimeout(function(){
							$('.sitetip-sitetip').css({"background-color":"#836FFF"});
							$('.sitetip-name').css({"color":"#836FFF"});
							$('.sitetip-name').text(sitetiparr[1].sitetipName);
							$('.sitetip-content').text(sitetiparr[1].sitetipContent);
							console.log("定时器000");
						},100);

						//为站点公告设置“滚动定时器” 并设置样式,
						var t1 = window.setInterval(function(){
							$('.sitetip-sitetip').css({"background-color":"#8EC55F"});
							$('.sitetip-name').css({"color":"#8EC55F"});
							$('.sitetip-name').text(sitetiparr[0].sitetipName);
							$('.sitetip-content').text(sitetiparr[0].sitetipContent);
							console.log("定时器111");
						},5000);

						var t2 = window.setInterval(function(){
							$('.sitetip-sitetip').css({"background-color":"#836FFF"});
							$('.sitetip-name').css({"color":"#836FFF"});
							$('.sitetip-name').text(sitetiparr[1].sitetipName);
							$('.sitetip-content').text(sitetiparr[1].sitetipContent);
							console.log("定时器222");
						},10000);

						/*window.clearInterval(t1); //去掉定时器的方法*/

					}else{}
				},
				fail : function () {
					console.log("失败");
				},
				error : function () {
					console.log("错误");
				}

			});

			<!--处理站点公告点击事件-->
			$('.sitetip-a').click(function () {

				layer.alert($('.sitetip-content').text(), {
					icon: 6,
					title: $('.sitetip-name').text()
				});

			});


			<!--获取指定范围内的文章信息的ajax-->
			$.ajax({
				type : "GET",
				url : "/article/findAllArticle",
				data : {
					"startIndex" : 0,
					"pageSize" : 5
				},
				dataType : "json",
				success : function (result1) {
					console.log(result1);

					if(result1.status == 200){
						/*var listlength = result.data.length;*/
						var articlearr = result1.data;

						//jquery动态拼接li标签
						for(let i in articlearr){

							(function (i) {    //这里采用形如：(function(i){...})(i)的闭包方式解决var声明变量的作用域和js回收机制问题
					<!--内套获取文章标签和评论数信息的ajax-->	//这里也可以直接用将var 变为let去声明变量就不需要闭包了！
								$.ajax({
									type : "GET",
									url : "/articleandlabel/findArticleAndLabelAndArticleCountById",
									data : {
										"articleId" : parseInt(articlearr[i].articleId)
									},
									dataType : "json",
									success : function (result2) {
										if(result2.status == 200){
											var labelstr="";
											var publishTime = layui.util.toDateString(articlearr[i].publishTime, 'yyyy-MM-dd HH:mm:ss')//时间戳->常规时间格式
											var articleandlabelarr = result2.data.articleAndLabelList;  //获取该文章标签信息的list
											var articleCount = result2.data.articleCount;               //获取该文章的评论总数
											for(let j in articleandlabelarr){
												labelstr += '<a class="label label-default">'+articleandlabelarr[j].labelName+'</a>';
												/*console.log("{}{}{}{}}{}labelstr11 : " + labelstr);*/
											}

											/*//动态拼接首页左边最新发布的列表的子元素
											$('.contentList').append('<div class="panel panel-default"><div class="panel-body"><div class="contentleft article-firstdiv">'
												+'<h4><a class="title" href="/article_detail.html">'+articlearr[i].title+'</a></h4>'
												+'<p>'+labelstr+'</p>'
												+'<p class="overView">'+articlearr[i].content.substr(0,200)+'</p>'
												+'<p><span class="count"><i class="glyphicon glyphicon-user"></i><a href="#">'+articlearr[i].author
												+'</a></span> <span class="count"><i class="glyphicon glyphicon-eye-open"></i>阅读:'+articlearr[i].readingNum
												+'</span><span class="count"><i class="glyphicon glyphicon-comment"></i>'
												+"评论:"+articleCount+'</span><span class="count"><i class="glyphicon glyphicon-time"></i>'+publishTime
												+'</span></p></div>'+'<div class="contentImage article-seconddiv"><div class="row"><a href="#" class="thumbnail w_thumbnail">'
												+'<img src="'+articlearr[i].articleImg+'" alt="...">'+'</a></div></div></div></div>');
*/
											//动态拼接首页左边最新发布的列表的子元素
											$('.contentList').append('<div class="panel panel-default"><div class="panel-body"><div class="contentleft article-firstdiv">'
												+'<h4><a class="title article-a-getid" href="/article_detail.html?articleId='+articlearr[i].articleId+'" articleid="'+articlearr[i].articleId+'" readingnum="'+articlearr[i].readingNum+'">'+ articlearr[i].title +'</a></h4>'
												+'<p>'+ labelstr +'</p>'
												+'<p class="overView">'+ articlearr[i].content.substr(0,200) +'</p>'
												+'<p><span class="count"><i class="glyphicon glyphicon-user"></i><a href="/about.html">'+ articlearr[i].author +'</a></span> '
												+'<span class="count"><i class="glyphicon glyphicon-eye-open"></i>阅读:'+ articlearr[i].readingNum +'</span>'
												+'<span class="count"><i class="glyphicon glyphicon-comment"></i>评论:'+ articleCount +'</span>'
												+'<span class="count"><i class="glyphicon glyphicon-time"></i>'+ publishTime +'</span></p></div>'
												+'<div class="contentImage article-seconddiv"><div class="row"><a href="#" class="thumbnail w_thumbnail">'
												+'<img src="'+ articlearr[i].articleImg +'" alt="...">'+'</a></div></div></div></div>');




										}else{}
									},
									fail : function () {
										console.log("fail");
									},
									error : function () {
										console.log("error");
									}

								});
							})(i);
						};

					}else{}
				},
				fail : function () {
					console.log("fail!")
				},
				error : function () {
					console.log("error!")
				}
			});



			<!--获取指定范围内的文章信息(其实只获取文章标题)的ajax-->
			$.ajax({
				type: "GET",
				url: "/article/findAllArticle",
				data: {
					"startIndex": 0,
					"pageSize": 10
				},
				dataType: "json",
				success : function (result) {
					if(result.status == 200){

						var articlearr = result.data;

						//jquery动态拼接li标签
						for(let i in articlearr){

							//动态拼接首页右边的简单的最新发布列表子元素
							$('.newpublish-ul').append('<li><a class="article-a-getid" href="/article_detail.html?articleId='+articlearr[i].articleId+'" articleid="'+articlearr[i].articleId+'" readingnum="'+articlearr[i].readingNum+'">'+articlearr[i].title+'</a></li>');
						}

					}else{}
				},
				fail : function () {
					console.log("fail!")
				},
				error : function () {
					console.log("error!")
				}
			});

            //为解决jquery动态生成节点造成节点点击事件失效，这里我们采用js的事件委托机制处理
            $(document).on("click",".article-a-getid",function(){
                var readingnum = $(this).attr("readingnum"); //JQuery通过click事件获取当前点击对象的非固定属性
                var articleid = $(this).attr("articleid");  //这里没有到，阅读量+1 的动作可以在前台处理，也可以在数据库处理
               /* alert("点击a标签阅读量："+readingnum+"文章id："+articleid);
                console.log("点击a标签阅读量："+readingnum);*/

               //这是一个点击a标签后将阅读量+1 的ajax的post请求
                $.post("/article/updateTheArticleReadingNum", {
                    "articleId" : articleid,
                    "newAddNum" : 1},
                    function (result) {
                            console.log("阅读量+1成功！");
                     });

            });


		});


	</script>

</html>